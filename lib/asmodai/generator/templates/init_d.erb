#! /bin/sh
### BEGIN INIT INFO
# Provides:          <%= @info.daemon_name %>
# Required-Start:    $remote_fs $network
# Required-Stop:     $remote_fs $network
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Example initscript
# Description:       This file should be used to construct scripts to be
#                    placed in /etc/init.d.
### END INIT INFO

DESC="Asmodai-generated daemon"
NAME="<%= @info.daemon_name %>"
SCRIPTNAME=/etc/init.d/$NAME

do_start()
{
        sudo -u <%= @info.base_file_owner.name %> bash -l -c "cd <%= @info.path %> && asmodai start"
}

do_stop()
{
        sudo -u <%= @info.base_file_owner.name %> bash -l -c "cd <%= @info.path %> && asmodai stop"

	return 0
}

#
# Function that sends a SIGHUP to the daemon/service
#
do_reload() {
        do_stop
        do_start
	return 0
}

case "$1" in
  start)
	do_start
	;;
  stop)
	do_stop
	;;
  restart|force-reload)
    do_stop
    do_start
	;;
  *)
	echo "Usage: $SCRIPTNAME {start|stop|restart}" >&2
	exit 3
	;;
esac

:
